
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StarX AI</title>
    <!-- Thêm các thư viện cần thiết -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link rel="stylesheet" id="hljs-light-theme" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" id="hljs-dark-theme" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css" disabled>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <button class="new-chat-btn" id="newChatBtn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                </svg>
                Cuộc trò chuyện mới
            </button>
        </div>
        
        <div class="chat-history" id="chatHistory">
            <!-- Chat history items will be loaded here dynamically -->
        </div>
        
        <div class="sidebar-footer">
            <div class="user-profile">
                <div class="user-avatar message-avatar-bg">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user-icon lucide-user"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                </div>
                <span class="user-name">Profile</span>
            </div>
            <button class="theme-toggle-btn" id="upgradeBtn" title="Nâng cấp tài khoản">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.103l3-3m0 0l3 3m-3-3v10.197M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </button>
            <button class="theme-toggle-btn" id="themeToggleBtn" title="Chuyển đổi giao diện">
                <svg id="theme-icon-sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun-icon lucide-sun"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
                <svg id="theme-icon-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon-icon lucide-moon"><path d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"/></svg>
            </button>
        </div>
    </div>
    
    <!-- Sidebar overlay for mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <!-- Main content -->
    <div class="main-content">
        <!-- Mobile header -->
        <div class="mobile-header">
            <button class="menu-btn" id="menuBtn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                </svg>
            </button>
            <div class="mobile-title">StarX AI</div>
            <!-- Spacer div removed for a cleaner left-aligned title layout -->
        </div>
        
        <!-- Chat container -->
        <div class="chat-container" id="chatContainer">
            <!-- Empty state -->
            <div class="empty-state" id="emptyState">
                <h1><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="50" height="50"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z"></path></svg>StarX Ai</h1>
                <p>Hỏi tôi bất cứ điều gì, từ kiến thức chung đến các chủ đề chuyên sâu như lập trình, khoa học, lịch sử và hơn thế nữa.</p>
                
                <div class="capabilities">
                    <div class="capability-card">
                        <h3>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-notebook-pen-icon lucide-notebook-pen"><path d="M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4"/><path d="M2 6h4"/><path d="M2 10h4"/><path d="M2 14h4"/><path d="M2 18h4"/><path d="M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"/></svg>
                            Sáng tạo nội dung
                        </h3>
                        <p>Viết bài luận, kịch bản, thơ, mã code và nhiều hơn nữa với sự sáng tạo của AI.</p>
                    </div>
                    
                    <div class="capability-card">
                        <h3>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-icon lucide-file"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/></svg>
                            Phân tích tài liệu
                        </h3>
                        <p>Tải lên và phân tích tài liệu PDF, Word, Excel để trích xuất thông tin quan trọng.</p>
                    </div>

                    <div class="capability-card">
                        <h3>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code-xml-icon lucide-code-xml"><path d="m18 16 4-4-4-4"/><path d="m6 8-4 4 4 4"/><path d="m14.5 4-5 16"/></svg>
                            Hỗ trợ lập trình
                        </h3>
                        <p>Giải thích code, gỡ lỗi, tối ưu hóa và tạo mã cho nhiều ngôn ngữ lập trình.</p>
                    </div>

                    <div class="capability-card">
                        <h3>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sprout-icon lucide-sprout"><path d="M14 9.536V7a4 4 0 0 1 4-4h1.5a.5.5 0 0 1 .5.5V5a4 4 0 0 1-4 4 4 4 0 0 0-4 4c0 2 1 3 1 5a5 5 0 0 1-1 3"/><path d="M4 9a5 5 0 0 1 8 4 5 5 0 0 1-8-4"/><path d="M5 21h14"/></svg>
                            Kiến thức chuyên sâu
                        </h3>
                        <p>Truy cập kiến thức cập nhật về khoa học, công nghệ, kinh doanh và nhiều lĩnh vực khác.</p>
                    </div>
                </div>
            </div>
            
            <!-- Chat messages will be added here dynamically -->
            
            <!-- Typing indicator -->
            <div class="typing-indicator" id="typingIndicator">
                <div class="message-ai"> <!-- Wrapper to apply correct CSS context -->
                    <div class="message-avatar">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z" />
                        </svg>
                    </div>
                </div>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>

            <!-- File Status Indicator -->
            <div class="typing-indicator" id="fileStatusIndicator" style="display: none;">
                <div class="message-avatar">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13" />
                    </svg>
                </div>
                <div id="fileStatusText" style="color: var(--text-secondary); flex: 1; line-height: 1.4;"></div>
            </div>
        </div>
        
        <!-- Input area -->
        <div class="input-area">
            <div class="input-container">
                <textarea class="input-box" id="messageInput" placeholder="Nhập tin nhắn của bạn..." rows="1"></textarea>
                <div class="input-actions">
                    <label class="upload-btn" title="Tải lên tài liệu">
                        <input type="file" id="fileUpload" accept=".txt,.pdf,.jpg,.png,.jpeg,.ppt,.pptx,.html,.css,.js,.py,.lua" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-paperclip-icon lucide-paperclip"><path d="m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551"/></svg>
                    </label>                    
                    <div class="input-action-wrapper">
                        <button class="upload-btn deep-think-btn" id="deepThinkBtn" title="Chế độ suy nghĩ sâu (Deep Think)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-lightbulb-icon lucide-lightbulb"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>
                        </button>
                        <div class="deep-think-menu" id="deepThinkMenu">
                            <div class="deep-think-option" data-mode="normal">
                                <strong>Deep-Think</strong>
                                <p>Phản hồi tiêu chuẩn, nâng cao.</p>
                            </div>
                            <div class="deep-think-option" data-mode="deeper">
                                <strong>Deeper-Think</strong>
                                <p>Suy nghĩ lâu hơn để có phản hồi tốt nhất.</p>
                            </div>
                            <div class="deep-think-option" data-mode="deepest">
                                <strong>Deepest-Think</strong>
                                <p>Suy nghĩ cẩn thận đưa phản hồi tốt nhất.</p>
                            </div>
                        </div>
                    </div>
                    <button class="upload-btn research-btn" id="researchBtn" title="Nghiên cứu chuyên sâu">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open-icon lucide-book-open"><path d="M12 7v14"/><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"/></svg>
                    </button>
                    <button class="upload-btn internet-search-btn" id="internetSearchBtn" title="Tìm kiếm trên Internet">
                        <svg xmlns="http://www.w3.org/2000/svg" width=20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search-icon lucide-search"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg>
                    </button>
                    <div class="input-action-wrapper" id="intelligenceControl" style="display: none;">
                        <button class="upload-btn intelligence-btn" id="intelligenceBtn" title="Điều chỉnh độ thông minh">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-brain-icon lucide-brain"><path d="M12 18V5"/><path d="M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4"/><path d="M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5"/><path d="M17.997 5.125a4 4 0 0 1 2.526 5.77"/><path d="M18 18a4 4 0 0 0 2-7.464"/><path d="M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517"/><path d="M6 18a4 4 0 0 1-2-7.464"/><path d="M6.003 5.125a4 4 0 0 0-2.526 5.77"/></svg>
                        </button>
                        <div class="deep-think-menu" id="intelligenceMenu">
                            <div style="padding: 12px; width: 200px;">
                                <label for="intelligenceSlider" style="font-size: 14px; color: var(--text-secondary); display: flex; justify-content: space-between; align-items: center;">
                                    <span>Độ thông minh</span>
                                    <span id="intelligenceValue" style="font-weight: 600; color: var(--text-primary);">50</span>
                                </label>
                                <input type="range" id="intelligenceSlider" min="0" max="100" value="50" style="width: 100%; margin-top: 8px;">
                            </div>
                        </div>
                    </div>
                    <button class="send-btn" id="sendBtn" disabled>
                        <div class="spinner" id="sendSpinner"></div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-icon lucide-arrow-up"><path d="m5 12 7-7 7 7"/><path d="M12 19V5"/></svg>
                    </button>
                </div>
            </div>
            <p class="disclaimer-text">AI có thể mắc lỗi. Vui lòng kiểm tra thông tin quan trọng.</p>
        </div>
        
        <!-- Scroll to bottom button -->
        <button class="scroll-to-bottom" id="scrollToBottomBtn" title="Cuộn xuống dưới">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 13.5L12 21m0 0l-7.5-7.5M12 21V3" />
            </svg>
        </button>
    </div>

    <!-- Search Results Sidebar -->
    <div class="results-sidebar" id="resultsSidebar">
        <div class="results-sidebar-header">
            <h4>Kết quả tìm kiếm bổ sung</h4>
            <button class="close-results-btn" id="closeResultsBtn" title="Đóng">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        <div class="results-sidebar-content" id="resultsSidebarContent">
            <!-- Additional results will be injected here -->
        </div>
    </div>

    <!-- Code Preview Sidebar -->
    <div class="preview-sidebar" id="previewSidebar">
        <div class="preview-resize-handle" id="previewResizeHandle"></div>
        <div class="preview-sidebar-header">
            <h4 id="previewSidebarTitle">HTML Preview</h4>
            <button class="close-preview-btn" id="closePreviewBtn" title="Đóng">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        <div class="preview-sidebar-content">
            <iframe id="previewSidebarFrame" sandbox="allow-scripts allow-same-origin"></iframe>
        </div>
    </div>

    <!-- Research Modal -->
    <div class="modal-overlay" id="researchModalOverlay">
        <div class="modal-content" id="researchModalContent">
            <h3>Nghiên cứu chuyên sâu</h3>
            <p>Nhập chủ đề bạn muốn AI thực hiện một báo cáo chi tiết và toàn diện.</p>
            <form id="researchForm">
                <input type="text" id="researchTopicInput" class="modal-input" placeholder="Ví dụ: 'Lịch sử của trí tuệ nhân tạo'" required>
                <div class="modal-actions">
                    <button type="button" class="modal-btn modal-btn-secondary" id="cancelResearchBtn">Hủy</button>
                    <button type="submit" class="modal-btn modal-btn-primary">Bắt đầu</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Passkey Modal -->
    <div class="modal-overlay" id="passkeyModalOverlay">
        <div class="modal-content">
            <h3>Nâng cấp tài khoản</h3>
            <p>Nhập Pass-Key của bạn để mở khóa các tính năng cao cấp và tăng giới hạn sử dụng.</p>
            <form id="passkeyForm">
                <input type="text" id="passkeyInput" class="modal-input" placeholder="Ví dụ: Plus-Alpha-Beta.12345" required>
                <div class="modal-actions">
                    <button type="button" class="modal-btn modal-btn-secondary" id="cancelPasskeyBtn">Hủy</button>
                    <button type="submit" class="modal-btn modal-btn-primary">Xác nhận</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="confirmationModalOverlay">
        <div class="modal-content">
            <h3 id="confirmationModalTitle"></h3>
            <p id="confirmationModalMessage"></p>
            <div class="modal-actions">
                <button type="button" class="modal-btn modal-btn-secondary" id="cancelConfirmationBtn">Hủy</button>
                <button type="button" class="modal-btn" id="confirmActionBtn">Xác nhận</button>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div class="modal-overlay" id="alertModalOverlay">
        <div class="modal-content">
            <h3 id="alertModalTitle">Thông báo</h3>
            <p id="alertModalMessage"></p>
            <div class="modal-actions">
                <button type="button" class="modal-btn modal-btn-primary" id="alertModalOkBtn">Đã hiểu</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toastNotification" class="toast-notification">
        <span id="toastMessage"></span>
    </div>

    <script src="script.js"></script>
</body>
</html>
